<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Python 爬虫学习（三） | Log'K'</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Python 爬虫学习（三）</h1><a id="logo" href="/.">Log'K'</a><p class="description">Learn more.</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Python 爬虫学习（三）</h1><div class="post-meta">Sep 28, 2015<span> | </span><span class="category"><a href="/categories/Python/">Python</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在<a href="http://www.kepenj.me/blog/2015/09/18/wan-zhao-pa-chong-xue-python-/(jin-jie-/" target="_blank" rel="external">Python爬虫学习（二）</a>中我们接触了到了第一个爬虫，扒取了百度某贴吧的页面信息并整体保存。下来我们就要从这些内容中去提取我们想要的信息了。例如每个楼层的用户信息，或者说只要这鞋页面中的图片，等等。</p>
<h2 id="我们之前拿到的数据"><a href="#我们之前拿到的数据" class="headerlink" title="我们之前拿到的数据"></a>我们之前拿到的数据</h2><p>先来看看我们之前保存的资源，也就是这些</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/python_2/3.png" alt="1.1"></p>
<p>我们来看看 00002.html 这个文件里面的内容。</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/python_3/1.png" alt="1.2"></p>
<p>各种 html 源码密密麻麻的排列，看的人甚是头晕。但就是这些东西构成了我们浏览器里面的页面，所以我们要做的就是弄懂这些 html 究竟是干什么的。当然 <a href="http://www.crummy.com/software/BeautifulSoup/#Download" target="_blank" rel="external">Beautiful Soup</a> 这个框架已经帮我们做好了 HTML 解析的大部分工作，算是玩爬虫都会用到的一个常用库。同样附上相关的<a href="http://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html" target="_blank" rel="external">中文文档地址</a>。</p>
<h2 id="我们应该知道一些-Web-知识"><a href="#我们应该知道一些-Web-知识" class="headerlink" title="我们应该知道一些 Web 知识"></a>我们应该知道一些 Web 知识</h2><p>作为一个高(Zhuang)级(bi)的开发者来讲，我们应该学会一些 Web 相关的技术知识点，这样以后遇到问题也能从根源上去分析、解决，而不单单依靠第三方来做这些，毕竟任何程序都是有 Bug 的，靠别人不如靠自己。</p>
<h3 id="HTML-基本格式"><a href="#HTML-基本格式" class="headerlink" title="HTML 基本格式"></a>HTML 基本格式</h3><p>还是老样子，上个 Hello World 来作为开头，代码如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello,World<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span>Hello,HTML<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is my first HTML.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">align</span>=<span class="string">"right"</span>&gt;</span>by KepenJ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>我们 Run 后的样式如下</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/python_3/2.png" alt="1.3"></p>
<p>这就是我们的一个最简单的 HTML 页面了，所以说 HTML 的最基本组成就是</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        /*这里是 HTML 相关的头信息*/</div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        /*这里才是我们页面用来展示的内容结构*/</div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>当然一个真正的 Web 页面远远不止这些，其中的还会包含 CSS 、 JS 布局页面和执行的脚本，关于 HTML 相关标签下面有所解释。</p>
<h3 id="HTML-的标签"><a href="#HTML-的标签" class="headerlink" title="HTML 的标签"></a>HTML 的标签</h3><p>我这里就无耻（逃…）的引用 HTML 标签当中针对 HTML 标签的注释。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--...--&gt;</span>        定义注释。</div><div class="line"><span class="meta">&lt;!DOCTYPE&gt;</span>        定义文档类型。</div><div class="line"><span class="tag">&lt;<span class="name">a</span>&gt;</span>                定义锚。</div><div class="line"><span class="tag">&lt;<span class="name">abbr</span>&gt;</span>            定义缩写。</div><div class="line"><span class="tag">&lt;<span class="name">acronym</span>&gt;</span>        定义只取首字母的缩写。</div><div class="line"><span class="tag">&lt;<span class="name">address</span>&gt;</span>        定义文档作者或拥有者的联系信息。</div><div class="line"><span class="tag">&lt;<span class="name">applet</span>&gt;</span>        不赞成使用。定义嵌入的 applet。</div><div class="line"><span class="tag">&lt;<span class="name">area</span>&gt;</span>            定义图像映射内部的区域。</div><div class="line"><span class="tag">&lt;<span class="name">article</span>&gt;</span>        定义文章。</div><div class="line"><span class="tag">&lt;<span class="name">aside</span>&gt;</span>            定义页面内容之外的内容。</div><div class="line"><span class="tag">&lt;<span class="name">audio</span>&gt;</span>            定义声音内容。</div><div class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>                定义粗体字。</div><div class="line"><span class="tag">&lt;<span class="name">base</span>&gt;</span>            定义页面中所有链接的默认地址或默认目标。</div><div class="line"><span class="tag">&lt;<span class="name">basefont</span>&gt;</span>        不赞成使用。定义页面中文本的默认字体、颜色或尺寸。</div><div class="line"><span class="tag">&lt;<span class="name">bdi</span>&gt;</span>            定义文本的文本方向，使其脱离其周围文本的方向设置。</div><div class="line"><span class="tag">&lt;<span class="name">bdo</span>&gt;</span>            定义文字方向。</div><div class="line"><span class="tag">&lt;<span class="name">big</span>&gt;</span>            定义大号文本。</div><div class="line"><span class="tag">&lt;<span class="name">blockquote</span>&gt;</span>    定义长的引用。</div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>            定义文档的主体。</div><div class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span>            定义简单的折行。</div><div class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>        定义按钮 (push button)。</div><div class="line"><span class="tag">&lt;<span class="name">canvas</span>&gt;</span>        定义图形。</div><div class="line"><span class="tag">&lt;<span class="name">caption</span>&gt;</span>        定义表格标题。</div><div class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span>        不赞成使用。定义居中文本。</div><div class="line"><span class="tag">&lt;<span class="name">cite</span>&gt;</span>            定义引用(citation)。</div><div class="line"><span class="tag">&lt;<span class="name">code</span>&gt;</span>            定义计算机代码文本。</div><div class="line"><span class="tag">&lt;<span class="name">col</span>&gt;</span>            定义表格中一个或多个列的属性值。</div><div class="line"><span class="tag">&lt;<span class="name">colgroup</span>&gt;</span>        定义表格中供格式化的列组。</div><div class="line"><span class="tag">&lt;<span class="name">command</span>&gt;</span>        定义命令按钮。</div><div class="line"><span class="tag">&lt;<span class="name">datalist</span>&gt;</span>        定义下拉列表。</div><div class="line"><span class="tag">&lt;<span class="name">dd</span>&gt;</span>            定义定义列表中项目的描述。</div><div class="line"><span class="tag">&lt;<span class="name">del</span>&gt;</span>            定义被删除文本。</div><div class="line"><span class="tag">&lt;<span class="name">details</span>&gt;</span>        定义元素的细节。</div><div class="line"><span class="tag">&lt;<span class="name">dir</span>&gt;</span>            不赞成使用。定义目录列表。</div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>            定义文档中的节。</div><div class="line"><span class="tag">&lt;<span class="name">dfn</span>&gt;</span>            定义定义项目。</div><div class="line"><span class="tag">&lt;<span class="name">dialog</span>&gt;</span>        定义对话框或窗口。</div><div class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span>            定义定义列表。</div><div class="line"><span class="tag">&lt;<span class="name">dt</span>&gt;</span>            定义定义列表中的项目。</div><div class="line"><span class="tag">&lt;<span class="name">em</span>&gt;</span>            定义强调文本。</div><div class="line"><span class="tag">&lt;<span class="name">embed</span>&gt;</span>            定义外部交互内容或插件。</div><div class="line"><span class="tag">&lt;<span class="name">fieldset</span>&gt;</span>        定义围绕表单中元素的边框。</div><div class="line"><span class="tag">&lt;<span class="name">figcaption</span>&gt;</span>    定义 figure 元素的标题。</div><div class="line"><span class="tag">&lt;<span class="name">figure</span>&gt;</span>        定义媒介内容的分组，以及它们的标题。</div><div class="line"><span class="tag">&lt;<span class="name">font</span>&gt;</span>            不赞成使用。定义文字的字体、尺寸和颜色。</div><div class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span>        定义 section 或 page 的页脚。</div><div class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span>            定义供用户输入的 HTML 表单。</div><div class="line"><span class="tag">&lt;<span class="name">frame</span>&gt;</span>            定义框架集的窗口或框架。</div><div class="line"><span class="tag">&lt;<span class="name">frameset</span>&gt;</span>        定义框架集。</div><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span> to <span class="tag">&lt;<span class="name">h6</span>&gt;</span>    定义 HTML 标题。</div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span>            定义关于文档的信息。</div><div class="line"><span class="tag">&lt;<span class="name">header</span>&gt;</span>        定义 section 或 page 的页眉。</div><div class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span>            定义水平线。</div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span>            定义 HTML 文档。</div><div class="line"><span class="tag">&lt;<span class="name">i</span>&gt;</span>                定义斜体字。</div><div class="line"><span class="tag">&lt;<span class="name">iframe</span>&gt;</span>        定义内联框架。</div><div class="line"><span class="tag">&lt;<span class="name">img</span>&gt;</span>            定义图像。</div><div class="line"><span class="tag">&lt;<span class="name">input</span>&gt;</span>            定义输入控件。</div><div class="line"><span class="tag">&lt;<span class="name">ins</span>&gt;</span>            定义被插入文本。</div><div class="line"><span class="tag">&lt;<span class="name">isindex</span>&gt;</span>        不赞成使用。定义与文档相关的可搜索索引。</div><div class="line"><span class="tag">&lt;<span class="name">kbd</span>&gt;</span>            定义键盘文本。</div><div class="line"><span class="tag">&lt;<span class="name">keygen</span>&gt;</span>        定义生成密钥。</div><div class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span>            定义 input 元素的标注。</div><div class="line"><span class="tag">&lt;<span class="name">legend</span>&gt;</span>        定义 fieldset 元素的标题。</div><div class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>            定义列表的项目。</div><div class="line"><span class="tag">&lt;<span class="name">link</span>&gt;</span>            定义文档与外部资源的关系。</div><div class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span>            定义图像映射。</div><div class="line"><span class="tag">&lt;<span class="name">mark</span>&gt;</span>            定义有记号的文本。</div><div class="line"><span class="tag">&lt;<span class="name">menu</span>&gt;</span>            定义菜单列表。</div><div class="line"><span class="tag">&lt;<span class="name">meta</span>&gt;</span>            定义关于 HTML 文档的元信息。</div><div class="line"><span class="tag">&lt;<span class="name">meter</span>&gt;</span>            定义预定义范围内的度量。</div><div class="line"><span class="tag">&lt;<span class="name">nav</span>&gt;</span>            定义导航链接。</div><div class="line"><span class="tag">&lt;<span class="name">noframes</span>&gt;</span>        定义针对不支持框架的用户的替代内容。</div><div class="line"><span class="tag">&lt;<span class="name">noscript</span>&gt;</span>        定义针对不支持客户端脚本的用户的替代内容。</div><div class="line"><span class="tag">&lt;<span class="name">object</span>&gt;</span>        定义内嵌对象。</div><div class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span>            定义有序列表。</div><div class="line"><span class="tag">&lt;<span class="name">optgroup</span>&gt;</span>        定义选择列表中相关选项的组合。</div><div class="line"><span class="tag">&lt;<span class="name">option</span>&gt;</span>        定义选择列表中的选项。</div><div class="line"><span class="tag">&lt;<span class="name">output</span>&gt;</span>        定义输出的一些类型。</div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>                定义段落。</div><div class="line"><span class="tag">&lt;<span class="name">param</span>&gt;</span>            定义对象的参数。</div><div class="line"><span class="tag">&lt;<span class="name">pre</span>&gt;</span>            定义预格式文本。</div><div class="line"><span class="tag">&lt;<span class="name">progress</span>&gt;</span>        定义任何类型的任务的进度。</div><div class="line"><span class="tag">&lt;<span class="name">q</span>&gt;</span>                定义短的引用。</div><div class="line"><span class="tag">&lt;<span class="name">rp</span>&gt;</span>            定义若浏览器不支持 ruby 元素显示的内容。</div><div class="line"><span class="tag">&lt;<span class="name">rt</span>&gt;</span>            定义 ruby 注释的解释。</div><div class="line"><span class="tag">&lt;<span class="name">ruby</span>&gt;</span>            定义 ruby 注释。</div><div class="line"><span class="tag">&lt;<span class="name">s</span>&gt;</span>                定义加删除线的文本。</div><div class="line"><span class="tag">&lt;<span class="name">samp</span>&gt;</span>            定义计算机代码样本。</div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="xml">        定义客户端脚本。</span></div><div class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span>        定义 section。</div><div class="line"><span class="tag">&lt;<span class="name">select</span>&gt;</span>        定义选择列表（下拉列表）。</div><div class="line"><span class="tag">&lt;<span class="name">small</span>&gt;</span>            定义小号文本。</div><div class="line"><span class="tag">&lt;<span class="name">source</span>&gt;</span>        定义媒介源。</div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>            定义文档中的节。</div><div class="line"><span class="tag">&lt;<span class="name">strike</span>&gt;</span>        不赞成使用。定义加删除线文本。</div><div class="line"><span class="tag">&lt;<span class="name">strong</span>&gt;</span>        定义强调文本。</div><div class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="xml">            定义文档的样式信息。</span></div><div class="line"><span class="tag">&lt;<span class="name">sub</span>&gt;</span>            定义下标文本。</div><div class="line"><span class="tag">&lt;<span class="name">summary</span>&gt;</span>        为 <span class="tag">&lt;<span class="name">details</span>&gt;</span> 元素定义可见的标题。</div><div class="line"><span class="tag">&lt;<span class="name">sup</span>&gt;</span>            定义上标文本。</div><div class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span>            定义表格。</div><div class="line"><span class="tag">&lt;<span class="name">tbody</span>&gt;</span>            定义表格中的主体内容。</div><div class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>            定义表格中的单元。</div><div class="line"><span class="tag">&lt;<span class="name">textarea</span>&gt;</span>        定义多行的文本输入控件。</div><div class="line"><span class="tag">&lt;<span class="name">tfoot</span>&gt;</span>            定义表格中的表注内容（脚注）。</div><div class="line"><span class="tag">&lt;<span class="name">th</span>&gt;</span>            定义表格中的表头单元格。</div><div class="line"><span class="tag">&lt;<span class="name">thead</span>&gt;</span>            定义表格中的表头内容。</div><div class="line"><span class="tag">&lt;<span class="name">time</span>&gt;</span>            定义日期/时间。</div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>            定义文档的标题。</div><div class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span>            定义表格中的行。</div><div class="line"><span class="tag">&lt;<span class="name">track</span>&gt;</span>            定义用在媒体播放器中的文本轨道。</div><div class="line"><span class="tag">&lt;<span class="name">tt</span>&gt;</span>            定义打字机文本。</div><div class="line"><span class="tag">&lt;<span class="name">u</span>&gt;</span>                定义下划线文本。</div><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>            定义无序列表。</div><div class="line"><span class="tag">&lt;<span class="name">var</span>&gt;</span>            定义文本的变量部分。</div><div class="line"><span class="tag">&lt;<span class="name">video</span>&gt;</span>            定义视频。</div><div class="line"><span class="tag">&lt;<span class="name">wbr</span>&gt;</span>            定义视频。</div><div class="line"><span class="tag">&lt;<span class="name">xmp</span>&gt;</span>            定义预格式文本。</div></pre></td></tr></table></figure>
<p>以上这些就是 HTML 现有标签的解释，相关的细节用法在 <a href="http://www.w3school.com.cn/html/index.asp" target="_blank" rel="external">W3School 中的 HTML 教程</a>中有非常详细的教程。</p>
<h3 id="HTML-解析神器——-BeautifulSoup"><a href="#HTML-解析神器——-BeautifulSoup" class="headerlink" title="HTML 解析神器—— BeautifulSoup"></a>HTML 解析神器—— BeautifulSoup</h3><p>当然 HTML 这块的解析我还是交由 <a href="http://www.crummy.com/software/BeautifulSoup/#Download" target="_blank" rel="external">BeautifulSoup</a> 来解析我们的数据，这么好的轮子不用太可惜了，哈哈哈～～这块就不再纠结于该库的导入问题，需要注意的就是 Python 2.x 和 Python 3 的兼容问题，相关库的使用方式可以参照 <a href="http://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html#id5" target="_blank" rel="external">安装 Beautiful Soup</a> 。</p>
<p>在代码中导入我们的库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">from bs4 import BeautifulSoup</div></pre></td></tr></table></figure>
<p>使用 BeautifulSoup() 函数来解析我们的 HTML</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">soup = BeautifulSoup(open(string.zfill(analytical_num,5) + &apos;.html&apos;))</div></pre></td></tr></table></figure>
<p>下图就是我们打印出来 soup 对象的部分内容截图，是不是很整齐，看着很舒爽呢</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/python_3/3.png" alt="1.4"></p>
<p>同样的我们就可以通过 . 语法来获取我们解析好的数据了。例如如果我要取 HTML 中的所有链接：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">link_list = soup.find_all(<span class="string">'link'</span>)</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> link_list:</div><div class="line">    <span class="keyword">print</span> i</div></pre></td></tr></table></figure>
<p>通过 <code>find_all()</code> 加上其中的关键字 link 我们就能打印出整个 HTML 当中包含 link 的内容了</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/python_3/4.png" alt="1.5"></p>
<p>无论是 <link> 、 </p><p> 还是 <b> ，无论是标签还是内容 BeautifulSoup 都为我们准备好了一套 API 供我们调用。当然我们可以全局去搜索我们的内容，我们也可以选择通过 BeautifulSoup 给我们拆分好的层级关系一级一级去调用，这两者的区别在于效率，也就是时间的消耗。所以说如果你需要更进一步的去采集 HTML 哪你需要的东西，那么更多关于 BeautifulSoup 的用法和 HTML 相关知识的掌握是不可缺少的。</b></p>
<h3 id="HTML-分析神器——-XPath"><a href="#HTML-分析神器——-XPath" class="headerlink" title="HTML 分析神器—— XPath"></a>HTML 分析神器—— XPath</h3><p>ok，我们现在已经大致了解 BeautifulSoup 的使用，下来就是针对这一大堆数据的收集了。也就是现在开始才是我们从繁杂的 HTML 页面数据中提取出我们想要的东西来。</p>
<p>当然，现今的浏览器，例如 Chrome 或者 FireFox 等，都自带了开发者工具，也就是我们可以通过这些工具一步步的查找到我们要的资源所在 HTML 中的位置。还用我们抓取下来的 0002.html 这个 HTML 文件为例，我们如何获取各个楼层中的用户头像图片呢？以下是这个页面在 Chrome 浏览器中显示：</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/python_3/5.png" alt="1.6"></p>
<p>的确， 你不得不佩服 Chrome 的强大之处。它的确给我定位出了当前图片的资源地址，但是如果要用到批量处理的情况下的话，这样获取资源的效率相对来讲还是有点慢。</p>
<p>但是！Chrome 的插件 XPath helper 解决了这个。插件的安装这里就不再复述，我们通过</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ control + <span class="built_in">shift</span> + x</div></pre></td></tr></table></figure>
<p>就可以呼叫出 XPath 控制台，开发者只需要按住 shift 见鼠标移到你想要抓取的资源上面的时候，就会在控制台上面显示出来。</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/python_3/6.png" alt="1.7"></p>
<p>但是你需要了解一点 XPath 的语法，这块给出一个 XPath 实例相信你看一遍就会明白。如果我们吧 XPath 当中显示的源码进行一下解析他大概的结构如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">/html</div><div class="line">    /body[@class='skin_normal']</div><div class="line">        /div[@class='wrap1']</div><div class="line">            /div[@class='wrap2']</div><div class="line">                /div[@id='container']</div><div class="line">                    /div[@class='content clearfix']</div><div class="line">                        /div[@id='pb_content']</div><div class="line">                            /div[@class='left_section']</div><div class="line">                                /div[@id='j_p_postlist']</div><div class="line">                                    /div[@class='l_post l_post_bright j_l_post clearfix  '][1]</div><div class="line">                                        /div[@class='d_author']</div><div class="line">                                            /ul[@class='p_author']</div><div class="line">                                                /li[@class='icon']</div><div class="line">                                                    /div[@class='icon_relative j_user_card']</div><div class="line">                                                        /a[@class='p_author_face ']</div><div class="line">                                                            /img</div><div class="line">                                                                /@src</div></pre></td></tr></table></figure>
<p>这个就是资额个资源文件在 HTML 当中的层级关系， 你可以把 /html 当做是 <code>&lt;html&gt;...&lt;/html&gt; ， ./div[@class=&#39;l_post l_post_bright j_l_post clearfix &#39;][1]</code> 当做是取 <code>class=&#39;l_post l_post_bright j_l_post clearfix</code>的标签 <div> 中的一个元素。</div></p>
<p>这样如果我要获取当前页帖子的所有楼层的用户头像地址和用户名的话，只需要这样改下之前的源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">content = soup.find_all(attrs=&#123;<span class="string">"class"</span>:<span class="string">"p_author_face "</span>&#125;)</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> content:</div><div class="line">    <span class="keyword">print</span> <span class="string">'hear_img_url:'</span>,i.img[<span class="string">'src'</span>]</div><div class="line">    <span class="keyword">print</span> <span class="string">'user_name_url:'</span>,i.img[<span class="string">'username'</span>]</div></pre></td></tr></table></figure>
<p>这解释我们解析后的结果</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/python_3/7.png" alt="1.8"></p>
<h3 id="存储我们的数据"><a href="#存储我们的数据" class="headerlink" title="存储我们的数据"></a>存储我们的数据</h3><p>当我们能够开始摘取我们需要的内容的时候，就要开始考虑如何将这些内容保存至本地，也就是所谓的数据持久化。<br>Python 当中针对系统文件读写的框架是 os ，我们可以在项目当中倒入这个框架来保存我们的数据。就还是用我们之前百度贴吧爬虫的例子为例，我们扒取每个页面当中，每个楼册用户的头像同时使用该用户的用户名来保存图片到本地。源码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">__author__ = <span class="string">'KepenJ'</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="keyword">import</span> urllib2,time,os</div><div class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_file</span><span class="params">(dir_name,user_name,file)</span>:</span></div><div class="line">    file_name = dir_name + <span class="string">"/"</span> + user_name + <span class="string">'.jpg'</span></div><div class="line">    f = open(file_name,<span class="string">'wb'</span>)</div><div class="line">    f.write(file)</div><div class="line">    f.close()</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_dir</span><span class="params">(dir_name)</span>:</span></div><div class="line">    os.mkdir(dir_name)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_user_pic</span><span class="params">(html_file)</span>:</span></div><div class="line">    soup= BeautifulSoup(html_file)</div><div class="line">    content = soup.find_all(attrs=&#123;<span class="string">"class"</span>:<span class="string">"p_author_face "</span>&#125;)</div><div class="line">    pic_array = list()</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> content:</div><div class="line">        pic_array.append(i.img[<span class="string">'src'</span>])</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> pic_array</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_user_name</span><span class="params">(html_file)</span>:</span></div><div class="line">    soup= BeautifulSoup(html_file)</div><div class="line">    content = soup.find_all(attrs=&#123;<span class="string">"class"</span>:<span class="string">"p_author_face "</span>&#125;)</div><div class="line">    name_array = list()</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> content:</div><div class="line">        name_array.append(i.img[<span class="string">'username'</span>])</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> name_array</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">baidu_tieba</span><span class="params">(begin_page,end_page,url)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(begin_page,end_page+<span class="number">1</span>):</div><div class="line">        <span class="keyword">print</span> <span class="string">'Downloading...Page: '</span>,i</div><div class="line">        reqest = urllib2.Request(url+<span class="string">'?'</span>+<span class="string">'pn='</span>+str(i))</div><div class="line">        html_file = urllib2.urlopen(reqest).read()</div><div class="line">        dir_name = str(time.time()) + <span class="string">"_userdir_"</span> + str(i)</div><div class="line">        make_dir(dir_name)</div><div class="line">        pic_array = get_user_pic(html_file)</div><div class="line">        name_array = get_user_name(html_file)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(pic_array)):</div><div class="line">            pic_link = urllib2.Request(pic_array[i])</div><div class="line">            pic_file = urllib2.urlopen(pic_link).read()</div><div class="line">            save_file(dir_name,name_array[i],pic_file)</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span> :</div><div class="line">    request_url = str(<span class="string">u'http://tieba.baidu.com/p/4041128662'</span>)</div><div class="line">    begin_num = int(raw_input(<span class="string">"start:"</span>))</div><div class="line">    end_num = int(raw_input(<span class="string">"end:"</span>))</div><div class="line">    baidu_tieba(begin_num,end_num,request_url)</div></pre></td></tr></table></figure>
<p>源码中我将之前 <code>baidu_tieba()</code> 中的方法摘取了出来，封装成了其余几个函数。</p>
<ul>
<li><code>save_file()</code> 用于文件存储的函数。</li>
<li><code>make_dir()</code> 创建文件夹的函数。</li>
<li><code>get_user_pic()</code> 从 BeautifulSoup 解析后的数据当中提取出用户头像的函数。</li>
<li><code>get_user_name()</code> 跟上面一样，提取出用户名称的函数。</li>
<li><code>baidu_tieba()</code> 和之前一样这个是我们爬虫的主要函数。</li>
</ul>
<p>之后 Run 我们的程序结果如下：</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/python_4/1.png" alt="1.9"></p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/python_4/2.png" alt="2.0"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在此，通过百度贴吧这个爬虫，帮助我们对 python 有了基本的入门语法和相关爬虫的实际操作。无论是 Python 还是爬虫的学习，我们都应该再接再厉继续研究和突破下去。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://www.crummy.com/software/BeautifulSoup/#Download" target="_blank" rel="external">Beautiful Soup 官方网站</a></p>
<p><a href="http://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html" target="_blank" rel="external">Beautiful Soup 参考文档中文地址</a></p>
<p><a href="http://baike.baidu.com/view/1117816.htm" target="_blank" rel="external">HTML 相关标签介绍</a></p>
<p><a href="http://www.w3school.com.cn/html/index.asp" target="_blank" rel="external">W3School 中的 HTML 教程</a></p>
<p><a href="http://www.w3school.com.cn/xpath/xpath_examples.asp" target="_blank" rel="external">XPath 实例教程</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2015/09/28/Python-爬虫学习（三）/" data-id="cis7dlg1g0007mmu5456eefiw" class="article-share-link">分享到</a><div class="tags"></div><div class="post-nav"><a href="/2015/10/22/Scrapy-爬虫学习中不可或缺的利器/" class="pre">Scrapy 爬虫学习中不可或缺的利器</a><a href="/2015/09/18/Python-爬虫学习（二）/" class="next">Python 爬虫学习（二）</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂感/">杂感</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/02/21/Apple-pay-体验报告/">Apple pay 体验报告</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/29/2015-终总结和-2016-的-flag/">2015 终总结和 2016 的 flag</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/22/Scrapy-爬虫学习中不可或缺的利器/">Scrapy 爬虫学习中不可或缺的利器</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/28/Python-爬虫学习（三）/">Python 爬虫学习（三）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/18/Python-爬虫学习（二）/">Python 爬虫学习（二）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/16/Python-爬虫学习（一）/">Python 爬虫学习（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/06/深入了解-iOS-中的-Block/">深入了解 iOS 中的 Block</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/08/20/在这个特殊的日子，我们来聊聊-KVO-吧/">在这个特殊的日子，我们来聊聊 KVO 吧</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/08/18/CodeSign和App的爱恨情仇/">CodeSign和App的爱恨情仇</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/08/06/iOS补漏和拾遗，从BAT的面试题出发（二）/">iOS补漏和拾遗，从BAT的面试题出发（二）</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/KepenJ" title="Github" target="_blank">Github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Log'K'.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>