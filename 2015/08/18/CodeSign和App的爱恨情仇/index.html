<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>CodeSign和App的爱恨情仇 | Log'K'</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">CodeSign和App的爱恨情仇</h1><a id="logo" href="/.">Log'K'</a><p class="description">Learn more.</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">CodeSign和App的爱恨情仇</h1><div class="post-meta">Aug 18, 2015<span> | </span><span class="category"><a href="/categories/iOS/">iOS</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><a id="more"></a>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前一个程序的闪退（非Crash）问题，这个问题现象类似于网上这个“<a href="http://zhidao.baidu.com/link?url=gZseOPAizICnKf6zhlfrj6_ShnUtIk9tAqMbkkpw0Fzq5g6_ZzAm4Wfk_x5u9kfC7EFpsAKt1vJ_X6YTB1QX7C9GcPvgcO7FYqphshIACJq" target="_blank" rel="external">itools安装应用闪退问题</a>”，然而这些问题的出现让我重新了解了 iOS 的证书、配置文件、ID 、 CodeSign 以及 Apple 针对 App 的部分安全机制相关知识点。</p>
<h2 id="Certificates-Identifiers-Profiles-amp-Devices"><a href="#Certificates-Identifiers-Profiles-amp-Devices" class="headerlink" title="Certificates, Identifiers, Profiles &amp; Devices"></a>Certificates, Identifiers, Profiles &amp; Devices</h2><p>如果我们想让自己的 App 运行于iOS设备上的话 Certificates, Identifiers, Profiles 这三样是必不可少的，而 Devices(设备的UUID) 则在我们进行真机测试的时候起到至关重要的作用。</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/2.png" alt="1.1"></p>
<p>其中关于这证书的申请，AppID的配置，Device UUID的获取等，可以参照<a href="http://ios.9tech.cn/news/2013/1011/33117.html" target="_blank" rel="external">iOS申请真机调试证书-图文详解</a>这篇博文。在这里主要梳理一下这4个东西在 CodeSign 中的作用和相关的其它知识点。</p>
<h3 id="Certificates"><a href="#Certificates" class="headerlink" title="Certificates"></a>Certificates</h3><p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/3.png" alt="1.2"></p>
<p>这个是我们的证书，我们在申请的时候会将本地申请好的的 CSR 文件，上传至 Apple 的 Member Center 。 Apple 证书颁发机构 <code>WWDRCA (Apple Worldwide Developer Relations Certification Authority)</code> 将使用 private key 对 CSR 中的 public key 和一些身份信息进行加密签名生成数字证书（ios_development.cer）并记录在案（Apple Member Center）。</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/4.png" alt="1.3"></p>
<p>同样的在我们的“钥匙串访问”程序中，其中的“专用密钥”就是我们CSR文件申请时候所预留下来的。而上层的“证书”则是我们在 Apple 数字签名后的公有证书。证书和密钥在我们之后的程序签名过程中缺一不可。</p>
<h3 id="Profiles-amp-Identifiers-amp-Devices"><a href="#Profiles-amp-Identifiers-amp-Devices" class="headerlink" title="Profiles &amp; Identifiers &amp; Devices"></a>Profiles &amp; Identifiers &amp; Devices</h3><p>在我们安装一个 App 的时候我们同时也会下载其配置文件(Provisioning Profile)，配置文件里面所包含的信息如下图：</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/5.png" alt="1.4"></p>
<p>它里面包含了如上三方面：</p>
<ul>
<li>App ID，也就是我们程序的Identifiers。</li>
<li>Device ID，就是我们注册的那些设备的唯一标识符（UUID）。</li>
<li>还有我们之前提到的 Apple 记录在案的证书。</li>
</ul>
<p>其中 App ID 分为了：Explicit 和 Wildcard 两种。</p>
<ul>
<li>Explicit App ID：唯一的App ID，用于唯一标识一个应用程序。例如“com.cbsi.55bbs”这个App ID，用于标识Bundle Identifier为“com.cbsi.55bbs”的App。</li>
<li>Wildcard App ID：含有通配符的App ID，用于标识一组应用程序。例如“”（实际上是Application Identifier Prefix）表示所有应用程序；而“com.apple.”可以表示Bundle Identifier以“com.cbsi”开头（CBSi 公司）的所有应用程序。</li>
</ul>
<p>如果你的应用中包含了某些授权的功能，类似<code>推送（APNS)</code>、<code>Game Center</code> 和 <code>iCloud</code> 服务，或者其他需求single app的应用，苹果规定你的App ID 一定要为 <code>Explicit</code> 为非 <code>Wildcard</code>。</p>
<p>那么什么时候才会用到Wildcard ID？ 在Xcode3.2中提出了<a href="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/5.png" target="_blank" rel="external">Team Provisioning Profile</a>这个概念，其中的“Team Provisioning Profile”中使用到了Wildcard ID，这个配置文件可以由Xcode自行生成。如下图：</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/7.png" alt="1.5"></p>
<p>关于Device ID 也就是设备的唯一标识符（UUID）这块，是针对真机测试而言。Apple 允许申请了 Apple Developer 账号的用户注册100台测试设备，以便于开发途中使用真机来测试开发者的 App。</p>
<h2 id="关于-CodeSign"><a href="#关于-CodeSign" class="headerlink" title="关于 CodeSign"></a>关于 CodeSign</h2><h3 id="一些闲话"><a href="#一些闲话" class="headerlink" title="一些闲话"></a>一些闲话</h3><p>上面无论是证书还是配置文件等，提出和这样设计的共同的目的就是 Apple 为了确保自身 iOS 设备上面运行的都是经过 Apple 审核过和注册过的开发者提供的 App 的安全性和唯一性。作为一个开发者而言这些条条框框无一降低了程序的扩展性和开源的可能，但是从用户的角度而言，这样提高了整体 iOS 应用的稳定和安全，特变是现在看到 Android App 的市场的混乱和各种不安全而言，Apple 的做法无一为用户考虑的更多。</p>
<h3 id="数字签名（CodeSigning）"><a href="#数字签名（CodeSigning）" class="headerlink" title="数字签名（CodeSigning）"></a>数字签名（CodeSigning）</h3><p>之前我们已经在本地存储了 Certificates 相关的证书和私钥，现在我们要做的就是将这些内容打包进我们的程序中。Xcode 已经为我们提供好了方法</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/9.png" alt="1.6"></p>
<p>上图就是我们在开发应用的时候所导入的证书，Xcode会使用codesign工具将签名证书打包进我们的程序当中，这个过程就是我们的”数字签名”。</p>
<p>我们可以通过终端调用codesign提供的命令去查看或修改一个 App 的数字签名，我们可以通过</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">codesign -vv <span class="_">-d</span> Example.app</div></pre></td></tr></table></figure>
<p>指令去查询一个 App 相关的 codesign 信息，就拿我曾经做过的一个项目来看</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/11.png" alt="1.7"></p>
<p>从这段codesign信息中我们就可以获取到这个 App 相关的</p>
<ul>
<li>程序的Bundle ID （Identifier=后面的信息）</li>
<li>程序所运行的系统架构信息（armv7 armv7s）</li>
<li>签名所用的证书信息（Authority=后面的信息）</li>
<li>签名的时间</li>
<li>执行文件的其他信息</li>
</ul>
<p>当然codesign工具还提供了程序完整性校验和修改 App 数字签名的功能：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// 校验</div><div class="line">codesign --verify Example.app  </div><div class="line">// 替换Example.app 相关的签名证书</div><div class="line">codesign <span class="_">-f</span> <span class="_">-s</span> <span class="string">'iPhone Developer: Thomas Kollbach (7TPNXN7G6K)'</span> Example.app</div></pre></td></tr></table></figure>
<p>如果当你将一个.ipa文件解压后，你会在他的程序包内发现一个文件夹和里面所包含的文件</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/10.png" alt="1.8"></p>
<p>当我们打开这个文件的时候你会发现如下信息：</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/12.png" alt="1.9"></p>
<p>上图中你可以看到类似</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>0.1.jpg<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span>XXXXXX<span class="tag">&lt;/<span class="name">data</span>&gt;</span></div></pre></td></tr></table></figure>
<p>这些正是除二进制文件以外，codesign针对程序内资源文件的“数字签名”，其目的在于更加有效确保应用的安全和完整性。</p>
<h3 id="授权机制-Entitlements"><a href="#授权机制-Entitlements" class="headerlink" title="授权机制 (Entitlements)"></a>授权机制 (Entitlements)</h3><p>众所周知，Apple为了使 iOS 系统运行的更加稳定和可控性，提出的“沙盒机制”也就是将开发者提供的应用的访问权限做一定的限制，从而使应用只能访问和修改自身，无法自由的影响 iOS 系统和其他的应用。“授权机制”也就孕育而生。</p>
<p>简单来说“授权机制”就是一个沙盒的配置列表，用来标注应用可访问的系统权限或者服务有哪些的XML文件。那我自身开发的应用来讲，通过codesign的命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">codesign <span class="_">-d</span> --entitlements - Example.app</div></pre></td></tr></table></figure>
<p>我们可以获得以下关于 App 授权的一些信息：</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/13.png" alt="2.0"></p>
<p>从这个XML文件我们获取到以下信息：</p>
<ul>
<li>访问系统 keychain 相关信息</li>
<li>开发者相关的标示（Team Identifier`）</li>
<li>App 的唯一标示（Bundle Indentifier）</li>
<li>可访问系统服务：推送服务（APNS），和其运行环境（production）</li>
</ul>
<h3 id="配置文件（Provisioning）"><a href="#配置文件（Provisioning）" class="headerlink" title="配置文件（Provisioning）"></a>配置文件（Provisioning）</h3><p>在上面我们提到了关于Profiles的内容，那么Profiles的功能则在于将我们的签名、授权、沙盒、iOS系统联系起来的文件。一样我们可以通过系统提供的security来看配置文件里面的信息，相关命令是：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">security cms -D -i example.mobileprovision</div></pre></td></tr></table></figure>
<p>还是那我们应用的配置文件来做个例子，通过这个命令我们会得到以下信息：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>AppIDName<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>XXXX<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>ApplicationIdentifierPrefix<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>XXXX<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>CreationDate<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">date</span>&gt;</span>2015-08-04T05:28:28Z<span class="tag">&lt;/<span class="name">date</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Platform<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>iOS<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>DeveloperCertificates<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">data</span>&gt;</span>XXXX<span class="tag">&lt;/<span class="name">data</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Entitlements<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>keychain-access-groups<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>XXXX<span class="tag">&lt;/<span class="name">string</span>&gt;</span>        </div><div class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>get-task-allow<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">true</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>application-identifier<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>XXXX<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.developer.team-identifier<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>XXXX<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>aps-environment<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>development<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>ExpirationDate<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">date</span>&gt;</span>2016-08-03T05:28:28Z<span class="tag">&lt;/<span class="name">date</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>55BBS_Dev<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>ProvisionedDevices<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line">        XXXX</div><div class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>TeamIdentifier<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line">        XXXX</div><div class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>TeamName<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>XXXX<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>TimeToLive<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">integer</span>&gt;</span>365<span class="tag">&lt;/<span class="name">integer</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>UUID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>XXXX<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Version<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">integer</span>&gt;</span>1<span class="tag">&lt;/<span class="name">integer</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></div></pre></td></tr></table></figure>
<p>在这里我使用XXXX替换掉了里面的<data></data>或者<string></string>内的相关内容，但是重点不在这些，而在于那些<key></key>标签。</p>
<p>纵览整个XML标签内容，我们可以获取到</p>
<ul>
<li>AppIDName 也就是我们的 App ID</li>
<li>ApplicationIdentifierPrefix 开发组的标示信息</li>
<li>CreationDate 配置文件创建的时间</li>
<li>Platform 应用可运行的平台</li>
<li>DeveloperCertificates 这一项是一个列表，包含了可以为使用这个配置文件的应用签名的所有证书</li>
<li>Entitlements 授权信息，也就是上面我们提到的“授权机制 (Entitlements)”的内容信息</li>
<li>ExpirationDate 配置文件过期日期</li>
<li>Name 配置文件的名称</li>
<li>ProvisionedDevices 配置文件所授权的 Device 的 UUID，也就是哪些设备是可以进行真机测试的</li>
<li>TeamIdentifier 开发 Team 的唯一标识符</li>
<li>TeamName 也就是开发者的信息</li>
<li>TimeToLive 存活时间</li>
<li>UUID 应用的UUID，这个是用来定位我们应用的唯一标识符，可用于符号化后定位部分 Crash 信息用</li>
<li>Version 版本信息</li>
</ul>
<h2 id="Apple-针对-App-的认证流程"><a href="#Apple-针对-App-的认证流程" class="headerlink" title="Apple 针对 App 的认证流程"></a>Apple 针对 App 的认证流程</h2><p>整理了以上这些内容，那么放到实际中，也就是我们 App 当中会有什么作用呢？还是见下图：</p>
<p><img src="https://raw.githubusercontent.com/KepenJ/BlogImages/master/CodeSign/14.png" alt="2.1"></p>
<p>当你的 App 要运行到设备的时候，iOS 的相关认证机制就会检测你 App 和一起下载的配置文件（Provisioning）相关内的信息，分为以下几步：</p>
<ol>
<li>检测 App 的 Bundle ID 是否匹配</li>
<li>检测应用授权（entitlements）信息是否匹配</li>
<li>相关数字签名（code signing）是否匹配</li>
<li>如果是真机测试的话还需要检测当前运行 Device UUID 是否包含在配置文件（Provisioning）内</li>
</ol>
<p>当这些信息都无误的情况下，系统就会认为当前 App 是被合法授权运行在 iOS 设备上的，也就可以进行下一步加载动态库，加载 main() ，创建 <code>UIApplication</code> 对象和代理… 这才开始运行起我们的程序。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>了解 Apple 的签名机制和在 App 里面的运用可以帮助我们了解 Apple 在 系统安全和应用安全相关的操作和设计，也为之后 iOS 相关“重打包”、“应用逆向”和“应用安全”奠定了基础。</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="http://blog.csdn.net/phunxm/article/details/42685597" target="_blank" rel="external">iOS Provisioning Profile(Certificate)与Code Signing详解</a></p>
<p><a href="http://objccn.io/issue-17-2/" target="_blank" rel="external">代码签名探析</a></p>
<p><a href="https://developer.apple.com/library/mac/documentation/Security/Conceptual/CodeSigningGuide/Introduction/Introduction.html" target="_blank" rel="external">Code Signing Guide</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2015/08/18/CodeSign和App的爱恨情仇/" data-id="cis8ow5r0000r4nu5a474k71r" class="article-share-link">分享到</a><div class="tags"></div><div class="post-nav"><a href="/2015/08/20/在这个特殊的日子，我们来聊聊-KVO-吧/" class="pre">在这个特殊的日子，我们来聊聊 KVO 吧</a><a href="/2015/08/06/iOS补漏和拾遗，从BAT的面试题出发（二）/" class="next">iOS补漏和拾遗，从BAT的面试题出发（二）</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C/">C++</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂感/">杂感</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/06/20/Github-代码阅读杂感——AFNetworking/">Github 代码阅读杂感——AFNetworking</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/05/C-学习笔记（六）：模板、字符串和异常/">C++学习笔记（六）：模板、字符串和异常</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/03/C-学习笔记（五）：运算符重载/">C++学习笔记（五）：运算符重载</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/01/C-学习笔记（四）：多态性与虚函数/">C++学习笔记（四）：多态性与虚函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/28/C-学习笔记（三）：继承和派生/">C++学习笔记（三）：继承和派生</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/22/Supporting-IPv6/">Supporting IPv6</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/21/C-学习笔记（二）：类和对象/">C++学习笔记（二）：类和对象</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/27/C-学习笔记（一）：C-基本和新增特性/">C++学习笔记（一）：C++基本和新增特性</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/21/iAP-的一波玩弄/">iAP 的一波玩弄</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/20/A-new-beginning/">A new beginning.</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/KepenJ" title="Github" target="_blank">Github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Log'K'.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>